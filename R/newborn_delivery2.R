#' Newborn delivery (alt. definition)
#'
#' @param output_folder the folder to write the output
#' @param anchor_date_table a data.frame containing two columns: person_id, anchor_date. A time window can be defined around the anchor date using the \code{before} and \code{after} arguments.
#' @param before an integer greater than or equal to 0. Dates prior to anchor_date + before will be excluded.
#' @param after an integer greater than or equal to 0. Dates after anchor_date + after will be excluded.
#' @return output_folder/newborn_delivery2.csv
#' @details Uses concept codes from https://pubmed.ncbi.nlm.nih.gov/38696234/
#' @export
newborn_delivery2 <- function(output_folder,anchor_date_table=NULL,before=NULL,after=NULL)
{
    codes <- c(46273629,46273305,46273304,46270991,44513733,44513729,42872493,42872492,42539210,42537021,42536960,42536954,42536952,40483521,40483126,40483101,38001486,38001485,37312440,37110284,4250010,4228344,4223536,4212794,4211824,4192676,4172142,4171820,4167089,4130321,4127252,4119336,4118802,4075182,4075161,4075160,4066112,4066111,4065739,4063163,4061457,4032767,4015701,2110324,2110323,2110317,2110316,2101814,2101807,2101016,2101013,2004802,2004789,2004786,437942,193277,46273629,46273305,46273304,45757174,44513756,44513752,44513747,44513746,44513745,44513743,44513740,44513736,42539267,42535817,42535816,37310404,37310393,37310369,36713074,4331179,4324549,4294827,4290245,4266683,4250441,4250009,4244672,4240325,4234710,4234421,4232028,4231702,4230533,4223638,4217642,4217586,4213387,4205240,4204679,4189205,4175637,4173513,4170626,4170152,4167018,4166775,4166247,4164221,4156948,4154615,4153284,4147974,4143647,4137400,4130319,4128031,4127705,4127251,4127250,4127249,4127248,4119050,4118904,4118903,4114637,4114636,4106406,4103850,4102595,4100410,4096145,4093774,4088084,4083524,4075735,4075191,4075190,4075189,4075188,4075187,4075171,4075170,4075169,4075168,4075165,4073438,4073424,4073422,4071630,4066113,4065737,4064824,4063162,4063160,4062136,4035778,4034145,4032766,4032764,4032762,4032761,4023797,4014720,4011047,3186670,2110321,2110319,2110309,2110308,2110307,2004731,2004730,2004726,2004724,2004710,2004707,2004702,442069,441641,440794,440793,440790,440462,438481,436767,435022,435018,434110,433260,73537,42539210,40483101,4063163,4064559,442422,442082,46270991,44513733,44513729,42872493,42872492,42537021,42536960,42536954,42536952,40483521,40483126,38001486,38001485,37312440,37110284,4250010,4228344,4223536,4212794,4211824,4192676,4172142,4171820,4167089,4130321,4127252,4119336,4118802,4075182,4075161,4075160,4066112,4066111,4065739,4061457,4032767,4015701,2110324,2110323,2110317,2110316,2101814,2101807,2101016,2101013,2004802,2004789,2004786,437942,193277,4129700,4066133,4066124,4066122,4065749,4065622,4065621,4065618,4064960,4064834,4064426,4064177,4064174,4064171,4063305,4063296,4063171,4063028,4062572,4062571,4062268,4062116,4062115,4061465,4061349,4061346,4060695,4060675,4060558,4060540,4060539,4060301,4060157,4059757,4058536,4058526,4058524,4058111,4058110,4028632,443521,443324,443294,443133,442829,442828,442420,442419,442418,442090,442089,442080,442072,442070,442059,442054,442053,442052,442049,442048,441924,441649,441645,441643,441630,441369,441363,440481,440475,439894,439095,439094,439092,439077,438490,438220,437936,437098,437055,436766,436183,436173,435612,435610,435609,435607,435330,435031,435020,434715,434713,434431,434427,434112,433812,433276,433274,432388,321367,320456,314103,313829,201912,201368,201359,200160,200157,199087,198816,198499,198486,198216,197616,197048,197042,196762,196182,196170,195878,195025,194711,194429,194113,193539,193535,193275,193271,193269,193264,192978,192971,192699,192387,192384,141639,138811,137940,135601,134414,133816,81357,81086,80782,80778,80479,80474,79897,79889,78494,77624,77621,77615,77347,77056,77052,76769,76761,75882,75326,74717,74440,74433,73824,73538,73526,72970,72697,72692,2784578,43018345,43018344,2784574,2784573,2784572,2784571,2784570,2784569,2784568,2784567,2784566,2784565,2784564,3174212,4008884,4014295,4014296,4014455,4014456,4015421,4015422,4029786,4049333,4052512,4054968,4066292,4069200,4082863,4092289,4094046,4097427,4101844,4107401,4142021,4145125,4147043,4163851,4172135,4178275,4193224,4199146,4227728,4241228,4243026,4246654,4272248,4307237,4310910,4330570,4336090,42535052,45757165,45757166,45757167,45757168,45757169,45765500,45765501,45765502,45772082,45773428,42539267,42539210,40483521,40483126,40483101,40483084,40482735,36717637,36713469,36713468,36713467,36713466,36713465,36713074)
    result_all <- aou.reader::concept_code_query(codes,anchor_date_table,before,after)
    .write_to_bucket(result_all,output_folder,"newborn_delivery2")
}